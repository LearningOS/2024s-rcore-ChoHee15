# chapter6

## 一、功能

在BlockInode中添加一个nlink维护有多少目录项指向了此node。

对于linkat，找到原路径文件的node，将其nlink加一；然后在root_inode所指目录中添加一个新目录项，指向原文件的node。
unlink做相反操作。而state读取对应BlockInode内容即可。



## 二、问答题

### 1. 在我们的easy-fs中，root inode起着什么作用？如果root inode中的内容损坏了，会发生什么？

对文件的查找从根目录开始向下逐级进行，root inode作为根目录的inode，是操作应用的对象，从某种意义上代表了这个文件系统。

类似于数据结构中的树：插入/删除/查找函数通常会以根节点作为参数，根节点代表了这棵树。

```c
void insert(Node* node, int val);

int main(){

    Node* root = create_tree(); // 创建一棵树
    
    insert(root, 1);

    return 0;
}
```

如果root inode中的内容损坏了，结果应该是未定义的。程序可能以各种姿势跑偏。

例如，inode中记录了block_id和block_offset；若这两项发生错误，则可能会导向错误的块，或者不存在的块，造成读写到其他文件或直接错误。






## 三、感受与建议

文件系统的概念和抽象比较多，且由于我是首次从code的一面接触文件系统，初见遇到了一些困难。但结合代码和文档，再和群友进行简单交流酒后，还是完成了测试。








# 荣誉准则

1. 在完成本次实验的过程（含此前学习的过程）中，我曾分别与**以下各位**就（与本次实验相关的）以下方面做过交流，还在代码中对应的位置以注释形式记录了具体的交流对象及内容：

> 微信群的群友

2. 此外，我也参考了**以下资料**，还在代码中对应的位置以注释形式记录了具体的参考来源及内容：

> NULL

3. 我独立完成了本次实验除以上方面之外的所有工作，包括代码与文档。我清楚地知道，从以上方面获得的信息在一定程度上降低了实验难度，可能会影响起评分。

4. 我从未使用过他人的代码，不管是原封不动地复制，还是经过了某些等价转换。我未曾也不会向他人（含此后各届同学）复制或公开我的实验代码，我有义务妥善保管好它们。我提交至本实验的评测系统的代码，均无意于破坏或妨碍任何计算机系统的正常运转。我清楚地知道，以上情况均为本课程纪律所禁止，若违反，对应的实验成绩将按“-100”分计。













# chapter7



## 一、问答题

### 1. 举出使用 pipe 的一个实际应用的例子。

objdump后通过管道传给vim，用更好的格式阅读汇编。




### 2. 如果需要在多个进程间互相通信，则需要为每一对进程建立一个管道，非常繁琐，请设计一个更易用的多进程通信机制。

可以使用共享内存，给每个进程分配一块区域，用于存放消息。这种方法需要做好同步。







```c
void insert(Node* node, int val);

int main(){

    Node* root = create_tree(); // 创建一棵树
    
    insert(root, 1);

    return 0;
}
```

如果root inode中的内容损坏了，结果应该是未定义的。程序可能以各种姿势跑偏。

例如，inode中记录了block_id和block_offset；若这两项发生错误，则可能会导向错误的块，或者不存在的块，造成读写到其他文件或直接错误。






## 二、感受与建议

文件系统的概念和抽象比较多，且由于我是首次从code的一面接触文件系统，初见遇到了一些困难。但结合代码和文档，再和群友进行简单交流酒后，还是完成了测试。








# 荣誉准则

1. 在完成本次实验的过程（含此前学习的过程）中，我曾分别与**以下各位**就（与本次实验相关的）以下方面做过交流，还在代码中对应的位置以注释形式记录了具体的交流对象及内容：

> NULL

2. 此外，我也参考了**以下资料**，还在代码中对应的位置以注释形式记录了具体的参考来源及内容：

> 5月8日的视频课

3. 我独立完成了本次实验除以上方面之外的所有工作，包括代码与文档。我清楚地知道，从以上方面获得的信息在一定程度上降低了实验难度，可能会影响起评分。

4. 我从未使用过他人的代码，不管是原封不动地复制，还是经过了某些等价转换。我未曾也不会向他人（含此后各届同学）复制或公开我的实验代码，我有义务妥善保管好它们。我提交至本实验的评测系统的代码，均无意于破坏或妨碍任何计算机系统的正常运转。我清楚地知道，以上情况均为本课程纪律所禁止，若违反，对应的实验成绩将按“-100”分计。



